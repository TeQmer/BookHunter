# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é BookHunter –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ

–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø—É—Å–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –¥–æ–º–µ–Ω–æ–º –¥–ª—è —Ä–∞–±–æ—Ç—ã Telegram Mini App.

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞](#—á—Ç–æ-–Ω—É–∂–Ω–æ-–¥–ª—è-–∑–∞–ø—É—Å–∫–∞)
2. [–í—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞](#–≤—ã–±–æ—Ä-—Å–µ—Ä–≤–µ—Ä–∞)
3. [–í—ã–±–æ—Ä –¥–æ–º–µ–Ω–∞](#–≤—ã–±–æ—Ä-–¥–æ–º–µ–Ω–∞)
4. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-dns)
5. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-—Å–µ—Ä–≤–µ—Ä–∞)
6. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
7. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –∏ SSL](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-nginx-–∏-ssl)
8. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-telegram-bot)
9. [–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#–∑–∞–ø—É—Å–∫-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
10. [–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã](#–ø—Ä–æ–≤–µ—Ä–∫–∞-—Ä–∞–±–æ—Ç—ã)

---

## 1. –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:

- ‚úÖ **–°–µ—Ä–≤–µ—Ä** (VPS/VDS)
- ‚úÖ **–î–æ–º–µ–Ω** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `bookhunter.ru`)
- ‚úÖ **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π Let's Encrypt)
- ‚úÖ **Telegram Bot Token** (—á–µ—Ä–µ–∑ @BotFather)

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ:

- üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** (UptimeRobot, Sentry)
- üíæ **–ë—ç–∫–∞–ø—ã** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ)
- üîí **Firewall** (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π)

---

## 2. –í—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã:

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –¶–µ–Ω–∞ | –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è |
|-----------|------------------------|------|--------------|
| **Timeweb** | 2 CPU, 4 GB RAM, 40 GB SSD | ~300 ‚ÇΩ/–º–µ—Å | –ù–∞—á–∞–ª–æ |
| **Beget** | 2 CPU, 4 GB RAM, 50 GB SSD | ~350 ‚ÇΩ/–º–µ—Å | –ù–∞—á–∞–ª–æ |
| **Reg.ru** | 2 CPU, 4 GB RAM, 40 GB SSD | ~400 ‚ÇΩ/–º–µ—Å | –ù–∞—á–∞–ª–æ |
| **DigitalOcean** | 2 CPU, 4 GB RAM, 80 GB SSD | ~$20/–º–µ—Å | –ü—Ä–æ–µ–∫—Ç |
| **Hetzner** | 2 CPU, 4 GB RAM, 80 GB SSD | ~‚Ç¨10/–º–µ—Å | –ü—Ä–æ–µ–∫—Ç |

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

```
CPU: 2 —è–¥—Ä–∞
RAM: 4 –ì–ë
–î–∏—Å–∫: 40 –ì–ë SSD
–û–°: Ubuntu 22.04 LTS –∏–ª–∏ Debian 12
```

### –ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω —Å–µ—Ä–≤–µ—Ä?

- ‚ùå **–ù–µ–ª—å–∑—è** –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ –¥–æ–º–∞—à–Ω–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (–Ω–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ IP, –Ω–µ—Ç HTTPS)
- ‚ùå **–ù–µ–ª—å–∑—è** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Ö–æ—Å—Ç–∏–Ω–≥–∏ (–Ω–µ—Ç Docker, –Ω–µ—Ç PostgreSQL)
- ‚úÖ **–ù—É–∂–µ–Ω** VPS/VDS —Å–µ—Ä–≤–µ—Ä —Å –¥–æ—Å—Ç—É–ø–æ–º –ø–æ SSH

---

## 3. –í—ã–±–æ—Ä –¥–æ–º–µ–Ω–∞

### –ì–¥–µ –∫—É–ø–∏—Ç—å –¥–æ–º–µ–Ω:

| –†–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä | –¶–µ–Ω–∞ .ru | –¶–µ–Ω–∞ .com | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|-------------|----------|-----------|--------------|
| **Reg.ru** | 200 ‚ÇΩ/–≥–æ–¥ | 1000 ‚ÇΩ/–≥–æ–¥ | ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É—é |
| **Nic.ru** | 250 ‚ÇΩ/–≥–æ–¥ | 1200 ‚ÇΩ/–≥–æ–¥ | ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É—é |
| **2domains** | 150 ‚ÇΩ/–≥–æ–¥ | 900 ‚ÇΩ/–≥–æ–¥ | ‚úÖ –î–µ—à–µ–≤–æ |
| **Timeweb** | 200 ‚ÇΩ/–≥–æ–¥ | 1000 ‚ÇΩ/–≥–æ–¥ | ‚úÖ –£–¥–æ–±–Ω–æ |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –¥–æ–º–µ–Ω–∞:

- ‚úÖ **.ru** ‚Äî –¥–µ—à–µ–≤–ª–µ, –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –†–§
- ‚úÖ **–ö–æ—Ä–æ—Ç–∫–∏–π** ‚Äî –ª–µ–≥–∫–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å
- ‚úÖ **–õ–∞—Ç–∏–Ω–∏—Ü–∞** ‚Äî `bookhunter.ru` (–Ω–µ `–±—É–∫—Å—Ç—Ä–∞–∫–µ—Ä.—Ä—Ñ`)
- ‚úÖ **–ë–µ–∑ —Ü–∏—Ñ—Ä** ‚Äî `books.ru` (–Ω–µ `books123.ru`)

### –ü—Ä–∏–º–µ—Ä—ã —Ö–æ—Ä–æ—à–∏—Ö –¥–æ–º–µ–Ω–æ–≤:

- `bookhunter.ru`
- `skidkiknig.ru`
- `bookmonitor.ru`
- `bookdeals.ru`

---

## 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS

### –®–∞–≥ 4.1: –ö—É–ø–∏—Ç–µ –¥–æ–º–µ–Ω

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Reg.ru)
2. –ö—É–ø–∏—Ç–µ –¥–æ–º–µ–Ω
3. –ü–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è DNS

### –®–∞–≥ 4.2: –ü–æ–ª—É—á–∏—Ç–µ IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞

–ü–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ –≤–∞–º –ø—Ä–∏—à–ª—é—Ç:
- IP –∞–¥—Ä–µ—Å: `123.45.67.89`
- –î–æ—Å—Ç—É–ø—ã SSH: `root@123.45.67.89`

### –®–∞–≥ 4.3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ DNS –∑–∞–ø–∏—Å–∏

–í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–º–µ–Ω–æ–º –¥–æ–±–∞–≤—å—Ç–µ:

```
–¢–∏–ø: A
–ò–º—è: @ (–∏–ª–∏ –≤–∞—à–µ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è)
–ó–Ω–∞—á–µ–Ω–∏–µ: 123.45.67.89 (IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
TTL: 3600
```

```
–¢–∏–ø: A
–ò–º—è: www
–ó–Ω–∞—á–µ–Ω–∏–µ: 123.45.67.89 (IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
TTL: 3600
```

### –®–∞–≥ 4.4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [https://www.nslookup.io/](https://www.nslookup.io/) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```
bookhunter.ru ‚Üí 123.45.67.89
www.bookhunter.ru ‚Üí 123.45.67.89
```

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** DNS –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –æ—Ç 1 –¥–æ 24 —á–∞—Å–æ–≤!

---

## 5. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –®–∞–≥ 5.1: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@123.45.67.89
```

### –®–∞–≥ 5.2: –û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É

```bash
apt update && apt upgrade -y
```

### –®–∞–≥ 5.3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –ü–û

```bash
# Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# Docker Compose
curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose

# Nginx
apt install nginx -y

# Certbot (–¥–ª—è SSL)
apt install certbot python3-certbot-nginx -y

# Git
apt install git -y
```

### –®–∞–≥ 5.4: –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞

```bash
mkdir -p /var/www/bookhunter
cd /var/www/bookhunter
```

### –®–∞–≥ 5.5: –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç

```bash
# –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –Ω–∞ GitHub
git clone https://github.com/–≤–∞—à-—é–∑–µ—Ä–Ω–µ–π–º/bookhunter.git .

# –ò–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ SFTP
```

### –®–∞–≥ 5.6: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall

```bash
# –†–∞–∑—Ä–µ—à–∏—Ç–µ SSH, HTTP, HTTPS
ufw allow 22/tcp
ufw allow 80/tcp
ufw allow 443/tcp
ufw enable
```

---

## 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –®–∞–≥ 6.1: –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`

```bash
nano .env
```

### –®–∞–≥ 6.2: –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```env
# ========== –ë–ê–ó–ê –î–ê–ù–ù–´–• ==========
DATABASE_URL=postgresql+asyncpg://bookuser:–°–õ–û–ñ–ù–´–ô_–ü–ê–†–û–õ–¨_–ë–î@postgres:5432/book_discounts
POSTGRES_USER=bookuser
POSTGRES_PASSWORD=–°–õ–û–ñ–ù–´–ô_–ü–ê–†–û–õ–¨_–ë–î

# ========== REDIS ==========
REDIS_URL=redis://:–°–õ–û–ñ–ù–´–ô_–ü–ê–†–û–õ–¨_REDIS@redis:6379/0
REDIS_PASSWORD=–°–õ–û–ñ–ù–´–ô_–ü–ê–†–û–õ–¨_REDIS

# ========== GOOGLE SHEETS ==========
GOOGLE_SHEETS_CREDENTIALS_PATH=credentials.json
GOOGLE_SHEET_ID=–≤–∞—à_id_google_—Ç–∞–±–ª–∏—Ü—ã

# ========== TELEGRAM BOT ==========
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞

# ========== TELEGRAM MINI APP ==========
MINI_APP_URL=https://bookhunter.ru/telegram

# ========== –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ ==========
SECRET_KEY=–°–õ–û–ñ–ù–´–ô_–°–ï–ö–†–ï–¢–ù–´–ô_–ö–õ–Æ–ß
ALGORITHM=HS256
ADMIN_USERNAME=admin
ADMIN_PASSWORD=–°–õ–û–ñ–ù–´–ô_–ü–ê–†–û–õ–¨_–ê–î–ú–ò–ù–ê

# ========== CORS ==========
ALLOWED_ORIGINS=https://bookhunter.ru,https://www.bookhunter.ru,https://t.me,https://web.telegram.org
ALLOWED_HOSTS=bookhunter.ru,www.bookhunter.ru

# ========== –ù–ê–°–¢–†–û–ô–ö–ò –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ==========
APP_NAME=BookHunter
DEBUG=False
LOG_LEVEL=INFO

# ========== CELERY ==========
CELERY_BROKER_URL=redis://:–°–õ–û–ñ–ù–´–ô_–ü–ê–†–û–õ–¨_REDIS@redis:6379/0
CELERY_RESULT_BACKEND=redis://:–°–õ–û–ñ–ù–´–ô_–ü–ê–†–û–õ–¨_REDIS@redis:6379/0
```

### –®–∞–≥ 6.3: –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è –¥–ª—è –ë–î
python3 -c "import secrets; print(secrets.token_urlsafe(32))"

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è –¥–ª—è Redis
python3 -c "import secrets; print(secrets.token_urlsafe(32))"

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SECRET_KEY
python3 -c "import secrets; print(secrets.token_urlsafe(32))"
```

–ó–∞–º–µ–Ω–∏—Ç–µ `–°–õ–û–ñ–ù–´–ô_–ü–ê–†–û–õ–¨` –Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è!

### –®–∞–≥ 6.4: –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª `credentials.json`

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª credentials.json —Å –≤–∞—à–∏–º Google Service Account –∫–ª—é—á–æ–º
nano credentials.json
```

–í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∞—à–µ–≥–æ `credentials.json` (–ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∏–∑ Google Cloud Console).

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `credentials.json` –ù–ï –≤ Git!

---

## 7. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –∏ SSL

### –®–∞–≥ 7.1: –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx

```bash
nano /etc/nginx/sites-available/bookhunter
```

### –®–∞–≥ 7.2: –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```nginx
# HTTP (–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ HTTPS)
server {
    listen 80;
    server_name bookhunter.ru www.bookhunter.ru;

    # –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤—Å–µ –Ω–∞ HTTPS
    return 301 https://$server_name$request_uri;
}

# HTTPS
server {
    listen 443 ssl http2;
    server_name bookhunter.ru www.bookhunter.ru;

    # SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (–±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã Certbot)
    ssl_certificate /etc/letsencrypt/live/bookhunter.ru/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/bookhunter.ru/privkey.pem;

    # SSL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;

    # –ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;

    # –õ–æ–≥–∏
    access_log /var/log/nginx/bookhunter_access.log;
    error_log /var/log/nginx/bookhunter_error.log;

    # –ü—Ä–æ–∫—Å–∏ –Ω–∞ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket –ø–æ–¥–¥–µ—Ä–∂–∫–∞
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
    location /static {
        alias /var/www/bookhunter/web/static;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }

    # Telegram Mini App
    location /telegram {
        alias /var/www/bookhunter/telegram/app;
        try_files $uri $uri/ /index.html;
    }
}
```

### –®–∞–≥ 7.3: –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

```bash
ln -s /etc/nginx/sites-available/bookhunter /etc/nginx/sites-enabled/
rm /etc/nginx/sites-enabled/default
```

### –®–∞–≥ 7.4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx

```bash
nginx -t
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `syntax is ok` –∏ `test is successful`

### –®–∞–≥ 7.5: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx

```bash
systemctl restart nginx
```

---

## 8. –ü–æ–ª—É—á–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

### –®–∞–≥ 8.1: –ü–æ–ª—É—á–∏—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

```bash
certbot --nginx -d bookhunter.ru -d www.bookhunter.ru
```

–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:
1. Email –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: `–≤–∞—à@email.com`
2. –°–æ–≥–ª–∞—Å–∏–µ —Å —É—Å–ª–æ–≤–∏—è–º–∏: `Y`
3. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP –Ω–∞ HTTPS: `2`

### –®–∞–≥ 8.2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
certbot renew --dry-run
```

### –®–∞–≥ 8.3: –î–æ–±–∞–≤—å—Ç–µ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ cron

```bash
crontab -e
```

–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:

```
0 3 * * * certbot renew --quiet && systemctl reload nginx
```

---

## 9. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot

### –®–∞–≥ 9.1: –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram: [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ: `/newbot`
3. –í–≤–µ–¥–∏—Ç–µ –∏–º—è –±–æ—Ç–∞: `bookhunter Bot`
4. –í–≤–µ–¥–∏—Ç–µ username –±–æ—Ç–∞: `bookhunter_bot`
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω: `1234567890:ABCdefGHIjklMNOpqrsTUVwxyz`

### –®–∞–≥ 9.2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Web App

–û—Ç–ø—Ä–∞–≤—å—Ç–µ @BotFather:

```
/mybots
```

–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ ‚Üí **Bot Settings** ‚Üí **Menu Button** ‚Üí **Setup Menu Button**

–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏:
```
üìö –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

URL Web App:
```
https://bookhunter.ru/telegram
```

### –®–∞–≥ 9.3: –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ `.env`

–û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ –∑–∞–º–µ–Ω–∏—Ç–µ:

```env
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
```

---

## 10. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –®–∞–≥ 10.1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker Compose

```bash
docker-compose up -d
```

### –®–∞–≥ 10.2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
docker-compose ps
```

–í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å `Up`

### –®–∞–≥ 10.3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

```bash
docker-compose logs -f app
```

### –®–∞–≥ 10.4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ Telegram –±–æ—Ç–∞

```bash
docker-compose exec telegram_bot python /app/app/run_bot.py
```

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–∞–∫ –¥–µ–º–æ–Ω:

```bash
docker-compose up -d telegram_bot
```

---

## 11. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –®–∞–≥ 11.1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ–±-—Å–∞–π—Ç

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

- ‚úÖ `http://bookhunter.ru` ‚Üí –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ HTTPS
- ‚úÖ `https://bookhunter.ru` ‚Üí –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Å–∞–π—Ç
- ‚úÖ `https://bookhunter.ru/telegram` ‚Üí –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è Mini App
- ‚úÖ `https://bookhunter.ru/admin` ‚Üí –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é)

### –®–∞–≥ 11.2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSL

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [https://www.ssllabs.com/ssltest/](https://www.ssllabs.com/ssltest/) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω.

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å **A+** –∏–ª–∏ **A**.

### –®–∞–≥ 11.3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram Bot

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram
2. –ù–∞–∂–º–∏—Ç–µ `/start`
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üìö –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
4. Mini App –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è!

### –®–∞–≥ 11.4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API

```bash
curl https://bookhunter.ru/api/health
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è JSON —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∑–¥–æ—Ä–æ–≤—å–µ —Å–∏—Å—Ç–µ–º—ã.

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [ ] –ö—É–ø–ª–µ–Ω –¥–æ–º–µ–Ω
- [ ] –ö—É–ø–ª–µ–Ω —Å–µ—Ä–≤–µ—Ä (VPS/VDS)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã DNS –∑–∞–ø–∏—Å–∏
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Docker –∏ Docker Compose
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Nginx
- [ ] –ü–æ–ª—É—á–µ–Ω SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- [ ] –°–æ–∑–¥–∞–Ω `.env` —Ñ–∞–π–ª
- [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
- [ ] –†–∞–∑–º–µ—â–µ–Ω `credentials.json`
- [ ] –°–æ–∑–¥–∞–Ω Telegram Bot
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω Web App URL
- [ ] –ó–∞–ø—É—â–µ–Ω—ã Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω –≤–µ–±-—Å–∞–π—Ç
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω Telegram Bot

---

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:

```bash
# –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose logs -f

# –¢–æ–ª—å–∫–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
docker-compose logs -f app

# –¢–æ–ª—å–∫–æ Telegram –±–æ—Ç
docker-compose logs -f telegram_bot
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:

```bash
# –í—Å–µ
docker-compose restart

# –¢–æ–ª—å–∫–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
docker-compose restart app

# –¢–æ–ª—å–∫–æ –±–æ—Ç
docker-compose restart telegram_bot
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:

```bash
docker-compose down
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
git pull
docker-compose down
docker-compose up -d --build
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞:

```bash
df -h
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RAM:

```bash
free -h
```

---

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –°–∞–π—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Nginx:
```bash
systemctl status nginx
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Docker:
```bash
docker-compose ps
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
docker-compose logs app
```

### –ü—Ä–æ–±–ª–µ–º–∞: SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**

```bash
certbot --nginx -d bookhunter.ru -d www.bookhunter.ru --force-renewal
```

### –ü—Ä–æ–±–ª–µ–º–∞: Telegram Bot –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ `.env`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞:
```bash
docker-compose logs telegram_bot
```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
```bash
docker-compose restart telegram_bot
```

### –ü—Ä–æ–±–ª–µ–º–∞: Mini App –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ Telegram

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `MINI_APP_URL` –≤ `.env`:
```env
MINI_APP_URL=https://bookhunter.ru/telegram
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `ALLOWED_ORIGINS`:
```env
ALLOWED_ORIGINS=https://bookhunter.ru,https://t.me,https://web.telegram.org
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Web App URL –≤ @BotFather

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Docker Documentation](https://docs.docker.com/)
- [Nginx Documentation](https://nginx.org/en/docs/)
- [Let's Encrypt](https://letsencrypt.org/)
- [Telegram Bot API](https://core.telegram.org/bots/api)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –Ω–∞—á–∞–ª–∞:

1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Timeweb –∏–ª–∏ Beget (–¥–µ—à–µ–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ)
2. ‚úÖ –ö—É–ø–∏—Ç–µ –¥–æ–º–µ–Ω .ru (–¥–µ—à–µ–≤–ª–µ)
3. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ubuntu 22.04 LTS
4. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker Compose –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry, UptimeRobot)
3. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (ELK Stack)
5. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Firewall

---

## üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!

–ï—Å–ª–∏ –≤—ã –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –≤—Å–µ —à–∞–≥–∏, –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –∏ Telegram Mini App –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å!

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ —ç—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª "–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º".

---

**–°–æ–∑–¥–∞–Ω–æ –¥–ª—è BookHunter** üìö‚ù§Ô∏è
